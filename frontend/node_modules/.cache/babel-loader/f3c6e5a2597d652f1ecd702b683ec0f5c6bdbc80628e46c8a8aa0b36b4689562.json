{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport axios from 'axios';\nimport moment from 'moment';\nexport default {\n  name: 'AdminLeaveManagement',\n  data() {\n    return {\n      leaveRequests: [],\n      showDetailsModalVisible: false,\n      selectedLeave: {},\n      searchQuery: '',\n      filterStatus: '',\n      dateRange: '',\n      sortKey: 'startDate',\n      sortDirection: 'desc',\n      currentPage: 1,\n      itemsPerPage: 10,\n      isLoading: false,\n      toastMessage: '',\n      toastType: 'success'\n    };\n  },\n  mounted() {\n    this.fetchLeaveRequests();\n  },\n  computed: {\n    filteredLeaveRequests() {\n      let filtered = [...this.leaveRequests];\n      if (this.searchQuery) {\n        const query = this.searchQuery.toLowerCase();\n        filtered = filtered.filter(leave => leave.employeeName.toLowerCase().includes(query) || leave.employeeId.toLowerCase().includes(query));\n      }\n      if (this.filterStatus) {\n        filtered = filtered.filter(leave => leave.status === this.filterStatus);\n      }\n      if (this.dateRange) {\n        const [year, month] = this.dateRange.split('-');\n        const startOfMonth = moment(`${year}-${month}-01`).startOf('month').toDate();\n        const endOfMonth = moment(startOfMonth).endOf('month').toDate();\n        filtered = filtered.filter(leave => {\n          const start = moment(leave.startDate).toDate();\n          return start >= startOfMonth && start <= endOfMonth;\n        });\n      }\n      filtered.sort((a, b) => {\n        const valueA = a[this.sortKey];\n        const valueB = b[this.sortKey];\n        if (this.sortKey === 'startDate' || this.sortKey === 'endDate') {\n          return this.sortDirection === 'asc' ? moment(valueA).diff(moment(valueB)) : moment(valueB).diff(moment(valueA));\n        }\n        return this.sortDirection === 'asc' ? valueA.localeCompare(valueB) : valueB.localeCompare(valueA);\n      });\n      return filtered;\n    },\n    totalPages() {\n      return Math.ceil(this.filteredLeaveRequests.length / this.itemsPerPage);\n    }\n  },\n  methods: {\n    async fetchLeaveRequests() {\n      try {\n        this.isLoading = true;\n        const response = await axios.get('http://localhost:7777/api/leaves/all');\n        this.leaveRequests = response.data.map(leave => ({\n          ...leave,\n          startDate: moment(leave.startDate).format('YYYY-MM-DD'),\n          endDate: moment(leave.endDate).format('YYYY-MM-DD')\n        })) || [];\n      } catch (error) {\n        console.error('Failed to fetch leave requests:', error);\n        this.showToast('Failed to load leave requests. Please try again.', 'error');\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    async refreshLeaveRequests() {\n      await this.fetchLeaveRequests();\n      this.showToast('Leave requests refreshed successfully!', 'success');\n    },\n    showDetailsModal(leave) {\n      this.selectedLeave = {\n        ...leave\n      };\n      this.showDetailsModalVisible = true;\n    },\n    closeDetailsModal() {\n      this.showDetailsModalVisible = false;\n      this.selectedLeave = {};\n    },\n    async approveLeave(id) {\n      try {\n        const response = await axios.put(`http://localhost:7777/api/leaves/${id}/approve`);\n        if (response.status === 200) {\n          this.leaveRequests = this.leaveRequests.map(leave => leave.id === id ? {\n            ...leave,\n            status: 'Approved'\n          } : leave);\n          if (this.showDetailsModalVisible) {\n            this.selectedLeave.status = 'Approved';\n          }\n          this.showToast('Leave approved successfully!', 'success');\n        }\n      } catch (error) {\n        console.error('Failed to approve leave:', error);\n        this.showToast('Failed to approve leave. Please try again.', 'error');\n      }\n    },\n    async disapproveLeave(id) {\n      try {\n        const response = await axios.put(`http://localhost:7777/api/leaves/${id}/disapprove`);\n        if (response.status === 200) {\n          this.leaveRequests = this.leaveRequests.map(leave => leave.id === id ? {\n            ...leave,\n            status: 'Disapproved'\n          } : leave);\n          if (this.showDetailsModalVisible) {\n            this.selectedLeave.status = 'Disapproved';\n          }\n          this.showToast('Leave disapproved successfully!', 'success');\n        }\n      } catch (error) {\n        console.error('Failed to disapprove leave:', error);\n        this.showToast('Failed to disapprove leave. Please try again.', 'error');\n      }\n    },\n    getStatusClass(status) {\n      switch (status) {\n        case 'Pending':\n          return 'text-yellow-600 bg-yellow-50 px-2 py-1 rounded-md';\n        case 'Approved':\n          return 'text-green-600 bg-green-50 px-2 py-1 rounded-md';\n        case 'Disapproved':\n          return 'text-red-600 bg-red-50 px-2 py-1 rounded-md';\n        default:\n          return 'text-gray-600 bg-gray-50 px-2 py-1 rounded-md';\n      }\n    },\n    formatDate(date) {\n      return moment(date).format('MMMM D, YYYY');\n    },\n    sortTable(key) {\n      if (this.sortKey === key) {\n        this.sortDirection = this.sortDirection === 'asc' ? 'desc' : 'asc';\n      } else {\n        this.sortKey = key;\n        this.sortDirection = 'asc';\n      }\n    },\n    applyDateFilter() {\n      this.currentPage = 1; // Reset to first page when filtering\n    },\n    prevPage() {\n      if (this.currentPage > 1) this.currentPage--;\n    },\n    nextPage() {\n      if (this.currentPage < this.totalPages) this.currentPage++;\n    },\n    showToast(message, type = 'success') {\n      this.toastMessage = message;\n      this.toastType = type;\n      setTimeout(() => this.clearToast(), 3000);\n    },\n    clearToast() {\n      this.toastMessage = '';\n      this.toastType = 'success';\n    }\n  }\n};","map":{"version":3,"names":["axios","moment","name","data","leaveRequests","showDetailsModalVisible","selectedLeave","searchQuery","filterStatus","dateRange","sortKey","sortDirection","currentPage","itemsPerPage","isLoading","toastMessage","toastType","mounted","fetchLeaveRequests","computed","filteredLeaveRequests","filtered","query","toLowerCase","filter","leave","employeeName","includes","employeeId","status","year","month","split","startOfMonth","startOf","toDate","endOfMonth","endOf","start","startDate","sort","a","b","valueA","valueB","diff","localeCompare","totalPages","Math","ceil","length","methods","response","get","map","format","endDate","error","console","showToast","refreshLeaveRequests","showDetailsModal","closeDetailsModal","approveLeave","id","put","disapproveLeave","getStatusClass","formatDate","date","sortTable","key","applyDateFilter","prevPage","nextPage","message","type","setTimeout","clearToast"],"sources":["C:\\Users\\ASUS\\Desktop\\OJT-PayrollSystem\\OJT-Payroll-System\\frontend\\src\\views\\admind\\EmployeeLeaveManagement.vue"],"sourcesContent":["<template>\r\n  <div class=\"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-1\">\r\n    <div class=\"max-w-8xl mx-auto\">\r\n      <header class=\"bg-white p-6 rounded-xl shadow-lg mb-6\">\r\n        <div class=\"flex justify-between items-center\">\r\n          <h1 class=\"text-2xl font-bold text-gray-900 flex items-center gap-2\">\r\n            <span class=\"material-icons text-blue-600\">event_note</span>\r\n            Employee Leave Management\r\n          </h1>\r\n          <button \r\n            @click=\"refreshLeaveRequests\" \r\n            class=\"inline-flex items-center gap-2 bg-blue-500 text-white px-3 py-1.5 rounded-md text-sm font-medium \r\n                   hover:bg-blue-600 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5\"\r\n          >\r\n            <span class=\"material-icons text-sm\">refresh</span>\r\n            Refresh\r\n          </button>\r\n        </div>\r\n      </header>\r\n\r\n      <!-- Filters and Search -->\r\n      <div class=\"bg-white rounded-xl shadow-lg p-5 mb-6 border border-gray-100\">\r\n        <div class=\"grid grid-cols-1 md:grid-cols-3 gap-5\">\r\n          <div class=\"relative\">\r\n            <label for=\"search\" class=\"block text-sm font-medium text-gray-700 mb-1\">Search Employees</label>\r\n            <div class=\"relative\">\r\n              <span class=\"material-icons absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\">\r\n                search\r\n              </span>\r\n              <input\r\n                id=\"search\"\r\n                v-model=\"searchQuery\"\r\n                type=\"text\"\r\n                placeholder=\"Search by name or ID...\"\r\n                class=\"w-full pl-10 pr-10 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 \r\n                       focus:border-blue-500 outline-none transition-all duration-200 text-sm\"\r\n              />\r\n              <button \r\n                v-if=\"searchQuery\" \r\n                @click=\"searchQuery = ''\"\r\n                class=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-700 transition-all duration-200\"\r\n              >\r\n                <span class=\"material-icons text-sm\">clear</span>\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"relative\">\r\n            <label for=\"statusFilter\" class=\"block text-sm font-medium text-gray-700 mb-1\">Filter by Status</label>\r\n            <div class=\"relative\">\r\n              <span class=\"material-icons absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\">\r\n                filter_list\r\n              </span>\r\n              <select\r\n                id=\"statusFilter\"\r\n                v-model=\"filterStatus\"\r\n                class=\"w-full pl-10 pr-9 py-2.5 border rounded-lg appearance-none focus:ring-2 \r\n                       focus:ring-blue-500 focus:border-blue-500 outline-none transition-all duration-200 text-sm\"\r\n              >\r\n                <option value=\"\">All Statuses</option>\r\n                <option value=\"Pending\">Pending</option>\r\n                <option value=\"Approved\">Approved</option>\r\n                <option value=\"Disapproved\">Disapproved</option>\r\n              </select>\r\n              <span class=\"material-icons absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none\">\r\n                arrow_drop_down\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"relative\">\r\n            <label for=\"dateRange\" class=\"block text-sm font-medium text-gray-700 mb-1\">Date Range</label>\r\n            <input\r\n              id=\"dateRange\"\r\n              v-model=\"dateRange\"\r\n              type=\"month\"\r\n              class=\"w-full px-10 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 \r\n                     focus:border-blue-500 outline-none transition-all duration-200 text-sm\"\r\n              @change=\"applyDateFilter\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Leave Requests Table -->\r\n      <div class=\"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100\">\r\n        <div class=\"px-6 py-4 border-b bg-gray-50 flex items-center justify-between\">\r\n          <h2 class=\"text-lg font-medium text-gray-900\">Leave Requests</h2>\r\n          <span class=\"text-sm text-gray-500\">Showing {{ filteredLeaveRequests.length }} {{ filteredLeaveRequests.length === 1 ? 'request' : 'requests' }}</span>\r\n        </div>\r\n\r\n        <div v-if=\"isLoading\" class=\"p-10 flex justify-center items-center\">\r\n          <div class=\"flex flex-col items-center\">\r\n            <div class=\"loader ease-linear rounded-full border-4 border-t-4 border-blue-200 h-12 w-12 mb-4 animate-spin\"></div>\r\n            <h3 class=\"text-lg font-medium text-gray-600\">Loading...</h3>\r\n          </div>\r\n        </div>\r\n\r\n        <div v-else-if=\"filteredLeaveRequests.length === 0\" class=\"p-12 text-center\">\r\n          <div class=\"rounded-full bg-blue-100 p-4 mb-4 inline-flex\">\r\n            <span class=\"material-icons text-blue-600 text-3xl\">event_busy</span>\r\n          </div>\r\n          <h3 class=\"text-xl font-semibold text-gray-900\">No Leave Requests Found</h3>\r\n          <p class=\"mt-2 text-gray-500 max-w-md mx-auto text-sm\">\r\n            There are no leave requests matching your criteria. Try adjusting your filters.\r\n          </p>\r\n        </div>\r\n\r\n        <transition-group name=\"table-fade\" tag=\"div\" class=\"overflow-x-auto\">\r\n          <table v-if=\"!isLoading && filteredLeaveRequests.length > 0\" \r\n                 class=\"min-w-full divide-y divide-gray-200\">\r\n            <thead class=\"bg-gray-50\">\r\n              <tr>\r\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer\"\r\n                    @click=\"sortTable('employeeName')\">\r\n                  Employee Name\r\n                  <span class=\"material-icons text-xs ml-1\">{{ sortDirection === 'asc' && sortKey === 'employeeName' ? 'arrow_drop_up' : 'arrow_drop_down' }}</span>\r\n                </th>\r\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer\"\r\n                    @click=\"sortTable('startDate')\">\r\n                  Start Date\r\n                  <span class=\"material-icons text-xs ml-1\">{{ sortDirection === 'asc' && sortKey === 'startDate' ? 'arrow_drop_up' : 'arrow_drop_down' }}</span>\r\n                </th>\r\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer\"\r\n                    @click=\"sortTable('endDate')\">\r\n                  End Date\r\n                  <span class=\"material-icons text-xs ml-1\">{{ sortDirection === 'asc' && sortKey === 'endDate' ? 'arrow_drop_up' : 'arrow_drop_down' }}</span>\r\n                </th>\r\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer\"\r\n                    @click=\"sortTable('status')\">\r\n                  Status\r\n                  <span class=\"material-icons text-xs ml-1\">{{ sortDirection === 'asc' && sortKey === 'status' ? 'arrow_drop_up' : 'arrow_drop_down' }}</span>\r\n                </th>\r\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody class=\"bg-white divide-y divide-gray-200\">\r\n              <tr v-for=\"leave in filteredLeaveRequests\" :key=\"leave.id\" class=\"transition-all duration-200 hover:bg-gray-50\">\r\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">{{ leave.employeeName }}</td>\r\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">{{ formatDate(leave.startDate) }}</td>\r\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">{{ formatDate(leave.endDate) }}</td>\r\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm font-semibold\"\r\n                    :class=\"getStatusClass(leave.status)\">\r\n                  {{ leave.status }}\r\n                </td>\r\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium flex gap-2\">\r\n                  <button @click=\"showDetailsModal(leave)\" \r\n                          class=\"inline-flex items-center gap-1.5 bg-blue-50 text-blue-600 py-1.5 px-2.5 rounded-md text-sm font-medium \r\n                                 hover:bg-blue-100 transition-all duration-200 shadow-sm hover:shadow-md transform hover:-translate-y-0.5\">\r\n                    <span class=\"material-icons text-xs\">visibility</span>\r\n                    View\r\n                  </button>\r\n                  <button @click=\"approveLeave(leave.id)\" \r\n                          :disabled=\"leave.status === 'Approved'\"\r\n                          class=\"inline-flex items-center gap-1.5 bg-green-50 text-green-600 py-1.5 px-2.5 rounded-md text-sm font-medium \r\n                                 hover:bg-green-100 transition-all duration-200 shadow-sm hover:shadow-md transform hover:-translate-y-0.5 disabled:opacity-50\">\r\n                    <span class=\"material-icons text-xs\">check</span>\r\n                    Approve\r\n                  </button>\r\n                  <button @click=\"disapproveLeave(leave.id)\" \r\n                          :disabled=\"leave.status === 'Disapproved'\"\r\n                          class=\"inline-flex items-center gap-1.5 bg-red-50 text-red-600 py-1.5 px-2.5 rounded-md text-sm font-medium \r\n                                 hover:bg-red-100 transition-all duration-200 shadow-sm hover:shadow-md transform hover:-translate-y-0.5 disabled:opacity-50\">\r\n                    <span class=\"material-icons text-xs\">close</span>\r\n                    Disapprove\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </transition-group>\r\n\r\n        <!-- Pagination -->\r\n        <div v-if=\"!isLoading && filteredLeaveRequests.length > itemsPerPage\" \r\n             class=\"px-6 py-4 bg-gray-50 border-t flex items-center justify-between\">\r\n          <div class=\"text-sm text-gray-700\">\r\n            Showing <span class=\"font-medium\">{{ ((currentPage - 1) * itemsPerPage) + 1 }}</span> to \r\n            <span class=\"font-medium\">{{ Math.min(currentPage * itemsPerPage, filteredLeaveRequests.length) }}</span> of \r\n            <span class=\"font-medium\">{{ filteredLeaveRequests.length }}</span> requests\r\n          </div>\r\n          <div class=\"flex items-center gap-2\">\r\n            <button\r\n              @click=\"prevPage\"\r\n              :disabled=\"currentPage === 1\"\r\n              class=\"p-2 rounded-md hover:bg-blue-100 transition-all duration-200 disabled:opacity-50 disabled:hover:bg-transparent text-gray-700\"\r\n            >\r\n              <span class=\"material-icons\">chevron_left</span>\r\n            </button>\r\n            <span class=\"text-sm text-gray-700\">{{ currentPage }} of {{ totalPages }}</span>\r\n            <button\r\n              @click=\"nextPage\"\r\n              :disabled=\"currentPage === totalPages\"\r\n              class=\"p-2 rounded-md hover:bg-blue-100 transition-all duration-200 disabled:opacity-50 disabled:hover:bg-transparent text-gray-700\"\r\n            >\r\n              <span class=\"material-icons\">chevron_right</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Email-Style Details Modal -->\r\n      <transition name=\"modal-slide\">\r\n        <div v-if=\"showDetailsModalVisible\" class=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50\">\r\n          <div class=\"bg-white p-6 rounded-xl shadow-lg max-w-2xl w-full transform transition-all duration-300 scale-100\">\r\n            <div class=\"border-b border-gray-200 pb-4 mb-4\">\r\n              <div class=\"flex justify-between items-center\">\r\n                <h2 class=\"text-lg font-semibold text-gray-800\">Leave Request Notification</h2>\r\n                <button @click=\"closeDetailsModal\" class=\"text-gray-600 hover:text-gray-800 p-1 rounded-full hover:bg-gray-100 transition-all duration-200\">\r\n                  <span class=\"material-icons text-lg\">close</span>\r\n                </button>\r\n              </div>\r\n              <div class=\"text-sm text-gray-500 mt-2\">From: HR System <span class=\"text-gray-400\">|</span> To: Admin</div>\r\n            </div>\r\n\r\n            <div class=\"mb-4\">\r\n              <h3 class=\"text-base font-medium text-gray-900\">Subject: Leave Request for {{ selectedLeave.employeeName }}</h3>\r\n              <p class=\"text-sm text-gray-600 mt-1\">Date: {{ formatDate(selectedLeave.startDate) }} – {{ formatDate(selectedLeave.endDate) }}</p>\r\n            </div>\r\n\r\n            <div class=\"bg-gray-50 p-4 rounded-lg mb-4 border border-gray-200\">\r\n              <p class=\"text-sm text-gray-700 whitespace-pre-wrap\">{{ selectedLeave.reason }}</p>\r\n            </div>\r\n\r\n            <div class=\"space-y-3 text-sm\">\r\n              <p class=\"text-gray-700\"><span class=\"font-medium text-gray-800\">Employee:</span> {{ selectedLeave.employeeName }}</p>\r\n              <p class=\"text-gray-700\"><span class=\"font-medium text-gray-800\">Employee ID:</span> {{ selectedLeave.employeeId }}</p>\r\n              <p class=\"text-gray-700\"><span class=\"font-medium text-gray-800\">Status:</span> \r\n                <span :class=\"getStatusClass(selectedLeave.status)\">{{ selectedLeave.status }}</span>\r\n              </p>\r\n            </div>\r\n\r\n            <div class=\"mt-6 flex justify-end gap-3\">\r\n              <button @click=\"approveLeave(selectedLeave.id)\" \r\n                      :disabled=\"selectedLeave.status === 'Approved'\"\r\n                      class=\"px-4 py-2 bg-green-500 text-white rounded-md text-sm font-medium hover:bg-green-600 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 disabled:opacity-50\">\r\n                Approve\r\n              </button>\r\n              <button @click=\"disapproveLeave(selectedLeave.id)\" \r\n                      :disabled=\"selectedLeave.status === 'Disapproved'\"\r\n                      class=\"px-4 py-2 bg-red-500 text-white rounded-md text-sm font-medium hover:bg-red-600 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 disabled:opacity-50\">\r\n                Disapprove\r\n              </button>\r\n              <button @click=\"closeDetailsModal\" \r\n                      class=\"px-4 py-2 bg-gray-500 text-white rounded-md text-sm font-medium hover:bg-gray-600 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5\">\r\n                Close\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </transition>\r\n\r\n      <!-- Toast Notifications -->\r\n      <div class=\"fixed bottom-4 right-4 z-50 space-y-4\">\r\n        <transition\r\n          enter-active-class=\"transform ease-out duration-300 transition\"\r\n          enter-from-class=\"translate-y-2 opacity-0 sm:translate-y-0 sm:translate-x-2\"\r\n          enter-to-class=\"translate-y-0 opacity-100 sm:translate-x-0\"\r\n          leave-active-class=\"transition ease-in duration-100\"\r\n          leave-from-class=\"opacity-100\"\r\n          leave-to-class=\"opacity-0\"\r\n        >\r\n          <div\r\n            v-if=\"toastMessage\"\r\n            class=\"max-w-sm w-full bg-white rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 overflow-hidden\"\r\n          >\r\n            <div class=\"p-4 flex items-center gap-3\">\r\n              <span \r\n                class=\"material-icons\"\r\n                :class=\"toastType === 'success' ? 'text-green-500' : 'text-red-500'\"\r\n              >\r\n                {{ toastType === 'success' ? 'check_circle' : 'error' }}\r\n              </span>\r\n              <p class=\"text-sm font-medium text-gray-900\">{{ toastMessage }}</p>\r\n              <button\r\n                @click=\"clearToast\"\r\n                class=\"ml-auto flex-shrink-0 rounded-md text-gray-400 hover:text-gray-500 \r\n                       focus:outline-none focus:ring-2 focus:ring-blue-500 p-1\"\r\n              >\r\n                <span class=\"material-icons text-sm\">close</span>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </transition>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport moment from 'moment';\r\n\r\nexport default {\r\n  name: 'AdminLeaveManagement',\r\n  data() {\r\n    return {\r\n      leaveRequests: [],\r\n      showDetailsModalVisible: false,\r\n      selectedLeave: {},\r\n      searchQuery: '',\r\n      filterStatus: '',\r\n      dateRange: '',\r\n      sortKey: 'startDate',\r\n      sortDirection: 'desc',\r\n      currentPage: 1,\r\n      itemsPerPage: 10,\r\n      isLoading: false,\r\n      toastMessage: '',\r\n      toastType: 'success'\r\n    };\r\n  },\r\n  mounted() {\r\n    this.fetchLeaveRequests();\r\n  },\r\n  computed: {\r\n    filteredLeaveRequests() {\r\n      let filtered = [...this.leaveRequests];\r\n\r\n      if (this.searchQuery) {\r\n        const query = this.searchQuery.toLowerCase();\r\n        filtered = filtered.filter(leave => \r\n          leave.employeeName.toLowerCase().includes(query) || \r\n          leave.employeeId.toLowerCase().includes(query)\r\n        );\r\n      }\r\n\r\n      if (this.filterStatus) {\r\n        filtered = filtered.filter(leave => leave.status === this.filterStatus);\r\n      }\r\n\r\n      if (this.dateRange) {\r\n        const [year, month] = this.dateRange.split('-');\r\n        const startOfMonth = moment(`${year}-${month}-01`).startOf('month').toDate();\r\n        const endOfMonth = moment(startOfMonth).endOf('month').toDate();\r\n        filtered = filtered.filter(leave => {\r\n          const start = moment(leave.startDate).toDate();\r\n          return start >= startOfMonth && start <= endOfMonth;\r\n        });\r\n      }\r\n\r\n      filtered.sort((a, b) => {\r\n        const valueA = a[this.sortKey];\r\n        const valueB = b[this.sortKey];\r\n        if (this.sortKey === 'startDate' || this.sortKey === 'endDate') {\r\n          return this.sortDirection === 'asc' \r\n            ? moment(valueA).diff(moment(valueB)) \r\n            : moment(valueB).diff(moment(valueA));\r\n        }\r\n        return this.sortDirection === 'asc' \r\n          ? valueA.localeCompare(valueB) \r\n          : valueB.localeCompare(valueA);\r\n      });\r\n\r\n      return filtered;\r\n    },\r\n    totalPages() {\r\n      return Math.ceil(this.filteredLeaveRequests.length / this.itemsPerPage);\r\n    }\r\n  },\r\n  methods: {\r\n    async fetchLeaveRequests() {\r\n      try {\r\n        this.isLoading = true;\r\n        const response = await axios.get('http://localhost:7777/api/leaves/all');\r\n        this.leaveRequests = response.data.map(leave => ({\r\n          ...leave,\r\n          startDate: moment(leave.startDate).format('YYYY-MM-DD'),\r\n          endDate: moment(leave.endDate).format('YYYY-MM-DD')\r\n        })) || [];\r\n      } catch (error) {\r\n        console.error('Failed to fetch leave requests:', error);\r\n        this.showToast('Failed to load leave requests. Please try again.', 'error');\r\n      } finally {\r\n        this.isLoading = false;\r\n      }\r\n    },\r\n    async refreshLeaveRequests() {\r\n      await this.fetchLeaveRequests();\r\n      this.showToast('Leave requests refreshed successfully!', 'success');\r\n    },\r\n    showDetailsModal(leave) {\r\n      this.selectedLeave = { ...leave };\r\n      this.showDetailsModalVisible = true;\r\n    },\r\n    closeDetailsModal() {\r\n      this.showDetailsModalVisible = false;\r\n      this.selectedLeave = {};\r\n    },\r\n    async approveLeave(id) {\r\n      try {\r\n        const response = await axios.put(`http://localhost:7777/api/leaves/${id}/approve`);\r\n        if (response.status === 200) {\r\n          this.leaveRequests = this.leaveRequests.map(leave => \r\n            leave.id === id ? { ...leave, status: 'Approved' } : leave\r\n          );\r\n          if (this.showDetailsModalVisible) {\r\n            this.selectedLeave.status = 'Approved';\r\n          }\r\n          this.showToast('Leave approved successfully!', 'success');\r\n        }\r\n      } catch (error) {\r\n        console.error('Failed to approve leave:', error);\r\n        this.showToast('Failed to approve leave. Please try again.', 'error');\r\n      }\r\n    },\r\n    async disapproveLeave(id) {\r\n      try {\r\n        const response = await axios.put(`http://localhost:7777/api/leaves/${id}/disapprove`);\r\n        if (response.status === 200) {\r\n          this.leaveRequests = this.leaveRequests.map(leave => \r\n            leave.id === id ? { ...leave, status: 'Disapproved' } : leave\r\n          );\r\n          if (this.showDetailsModalVisible) {\r\n            this.selectedLeave.status = 'Disapproved';\r\n          }\r\n          this.showToast('Leave disapproved successfully!', 'success');\r\n        }\r\n      } catch (error) {\r\n        console.error('Failed to disapprove leave:', error);\r\n        this.showToast('Failed to disapprove leave. Please try again.', 'error');\r\n      }\r\n    },\r\n    getStatusClass(status) {\r\n      switch (status) {\r\n        case 'Pending':\r\n          return 'text-yellow-600 bg-yellow-50 px-2 py-1 rounded-md';\r\n        case 'Approved':\r\n          return 'text-green-600 bg-green-50 px-2 py-1 rounded-md';\r\n        case 'Disapproved':\r\n          return 'text-red-600 bg-red-50 px-2 py-1 rounded-md';\r\n        default:\r\n          return 'text-gray-600 bg-gray-50 px-2 py-1 rounded-md';\r\n      }\r\n    },\r\n    formatDate(date) {\r\n      return moment(date).format('MMMM D, YYYY');\r\n    },\r\n    sortTable(key) {\r\n      if (this.sortKey === key) {\r\n        this.sortDirection = this.sortDirection === 'asc' ? 'desc' : 'asc';\r\n      } else {\r\n        this.sortKey = key;\r\n        this.sortDirection = 'asc';\r\n      }\r\n    },\r\n    applyDateFilter() {\r\n      this.currentPage = 1; // Reset to first page when filtering\r\n    },\r\n    prevPage() {\r\n      if (this.currentPage > 1) this.currentPage--;\r\n    },\r\n    nextPage() {\r\n      if (this.currentPage < this.totalPages) this.currentPage++;\r\n    },\r\n    showToast(message, type = 'success') {\r\n      this.toastMessage = message;\r\n      this.toastType = type;\r\n      setTimeout(() => this.clearToast(), 3000);\r\n    },\r\n    clearToast() {\r\n      this.toastMessage = '';\r\n      this.toastType = 'success';\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* Table row animation */\r\n.table-fade-enter-active, .table-fade-leave-active {\r\n  transition: all 0.3s ease;\r\n}\r\n.table-fade-enter-from, .table-fade-leave-to {\r\n  opacity: 0;\r\n  transform: translateY(30px);\r\n}\r\n\r\n/* Modal slide animation */\r\n.modal-slide-enter-active, .modal-slide-leave-active {\r\n  transition: all 0.3s ease;\r\n}\r\n.modal-slide-enter-from, .modal-slide-leave-to {\r\n  opacity: 0;\r\n  transform: translateY(-20px) scale(0.95);\r\n}\r\n\r\n/* Loader animation */\r\n.animate-spin {\r\n  animation: spin 1s linear infinite;\r\n}\r\n@keyframes spin {\r\n  to { transform: rotate(360deg); }\r\n}\r\n\r\n/* Button hover effects */\r\nbutton:hover:not(:disabled) {\r\n  transform: translateY(-2px);\r\n}\r\n\r\n/* Disabled button styles */\r\nbutton:disabled {\r\n  cursor: not-allowed;\r\n  transform: none !important;\r\n  box-shadow: none !important;\r\n}\r\n\r\n/* Responsive adjustments */\r\n@media (max-width: 640px) {\r\n  .grid-cols-3 {\r\n    grid-template-columns: 1fr;\r\n  }\r\n  .px-6 {\r\n    padding-left: 1rem;\r\n    padding-right: 1rem;\r\n  }\r\n  .text-xl {\r\n    font-size: 1.25rem;\r\n  }\r\n}\r\n\r\n/* Custom scrollbar for better UX */\r\n::-webkit-scrollbar {\r\n  width: 8px;\r\n  height: 8px;\r\n}\r\n::-webkit-scrollbar-track {\r\n  background: #f1f1f1;\r\n  border-radius: 10px;\r\n}\r\n::-webkit-scrollbar-thumb {\r\n  background: #888;\r\n  border-radius: 10px;\r\n}\r\n::-webkit-scrollbar-thumb:hover {\r\n  background: #555;\r\n}\r\n\r\n/* Focus states for accessibility */\r\ninput:focus, select:focus, button:focus {\r\n  outline: none;\r\n  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);\r\n}\r\n\r\n/* Improve hover states for better interactivity */\r\n.hover\\:bg-gray-50:hover {\r\n  background-color: #f9fafb;\r\n}\r\n</style>"],"mappings":";;;AAiSA,OAAOA,KAAI,MAAO,OAAO;AACzB,OAAOC,MAAK,MAAO,QAAQ;AAE3B,eAAe;EACbC,IAAI,EAAE,sBAAsB;EAC5BC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,aAAa,EAAE,EAAE;MACjBC,uBAAuB,EAAE,KAAK;MAC9BC,aAAa,EAAE,CAAC,CAAC;MACjBC,WAAW,EAAE,EAAE;MACfC,YAAY,EAAE,EAAE;MAChBC,SAAS,EAAE,EAAE;MACbC,OAAO,EAAE,WAAW;MACpBC,aAAa,EAAE,MAAM;MACrBC,WAAW,EAAE,CAAC;MACdC,YAAY,EAAE,EAAE;MAChBC,SAAS,EAAE,KAAK;MAChBC,YAAY,EAAE,EAAE;MAChBC,SAAS,EAAE;IACb,CAAC;EACH,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,kBAAkB,CAAC,CAAC;EAC3B,CAAC;EACDC,QAAQ,EAAE;IACRC,qBAAqBA,CAAA,EAAG;MACtB,IAAIC,QAAO,GAAI,CAAC,GAAG,IAAI,CAACjB,aAAa,CAAC;MAEtC,IAAI,IAAI,CAACG,WAAW,EAAE;QACpB,MAAMe,KAAI,GAAI,IAAI,CAACf,WAAW,CAACgB,WAAW,CAAC,CAAC;QAC5CF,QAAO,GAAIA,QAAQ,CAACG,MAAM,CAACC,KAAI,IAC7BA,KAAK,CAACC,YAAY,CAACH,WAAW,CAAC,CAAC,CAACI,QAAQ,CAACL,KAAK,KAC/CG,KAAK,CAACG,UAAU,CAACL,WAAW,CAAC,CAAC,CAACI,QAAQ,CAACL,KAAK,CAC/C,CAAC;MACH;MAEA,IAAI,IAAI,CAACd,YAAY,EAAE;QACrBa,QAAO,GAAIA,QAAQ,CAACG,MAAM,CAACC,KAAI,IAAKA,KAAK,CAACI,MAAK,KAAM,IAAI,CAACrB,YAAY,CAAC;MACzE;MAEA,IAAI,IAAI,CAACC,SAAS,EAAE;QAClB,MAAM,CAACqB,IAAI,EAAEC,KAAK,IAAI,IAAI,CAACtB,SAAS,CAACuB,KAAK,CAAC,GAAG,CAAC;QAC/C,MAAMC,YAAW,GAAIhC,MAAM,CAAC,GAAG6B,IAAI,IAAIC,KAAK,KAAK,CAAC,CAACG,OAAO,CAAC,OAAO,CAAC,CAACC,MAAM,CAAC,CAAC;QAC5E,MAAMC,UAAS,GAAInC,MAAM,CAACgC,YAAY,CAAC,CAACI,KAAK,CAAC,OAAO,CAAC,CAACF,MAAM,CAAC,CAAC;QAC/Dd,QAAO,GAAIA,QAAQ,CAACG,MAAM,CAACC,KAAI,IAAK;UAClC,MAAMa,KAAI,GAAIrC,MAAM,CAACwB,KAAK,CAACc,SAAS,CAAC,CAACJ,MAAM,CAAC,CAAC;UAC9C,OAAOG,KAAI,IAAKL,YAAW,IAAKK,KAAI,IAAKF,UAAU;QACrD,CAAC,CAAC;MACJ;MAEAf,QAAQ,CAACmB,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;QACtB,MAAMC,MAAK,GAAIF,CAAC,CAAC,IAAI,CAAC/B,OAAO,CAAC;QAC9B,MAAMkC,MAAK,GAAIF,CAAC,CAAC,IAAI,CAAChC,OAAO,CAAC;QAC9B,IAAI,IAAI,CAACA,OAAM,KAAM,WAAU,IAAK,IAAI,CAACA,OAAM,KAAM,SAAS,EAAE;UAC9D,OAAO,IAAI,CAACC,aAAY,KAAM,KAAI,GAC9BV,MAAM,CAAC0C,MAAM,CAAC,CAACE,IAAI,CAAC5C,MAAM,CAAC2C,MAAM,CAAC,IAClC3C,MAAM,CAAC2C,MAAM,CAAC,CAACC,IAAI,CAAC5C,MAAM,CAAC0C,MAAM,CAAC,CAAC;QACzC;QACA,OAAO,IAAI,CAAChC,aAAY,KAAM,KAAI,GAC9BgC,MAAM,CAACG,aAAa,CAACF,MAAM,IAC3BA,MAAM,CAACE,aAAa,CAACH,MAAM,CAAC;MAClC,CAAC,CAAC;MAEF,OAAOtB,QAAQ;IACjB,CAAC;IACD0B,UAAUA,CAAA,EAAG;MACX,OAAOC,IAAI,CAACC,IAAI,CAAC,IAAI,CAAC7B,qBAAqB,CAAC8B,MAAK,GAAI,IAAI,CAACrC,YAAY,CAAC;IACzE;EACF,CAAC;EACDsC,OAAO,EAAE;IACP,MAAMjC,kBAAkBA,CAAA,EAAG;MACzB,IAAI;QACF,IAAI,CAACJ,SAAQ,GAAI,IAAI;QACrB,MAAMsC,QAAO,GAAI,MAAMpD,KAAK,CAACqD,GAAG,CAAC,sCAAsC,CAAC;QACxE,IAAI,CAACjD,aAAY,GAAIgD,QAAQ,CAACjD,IAAI,CAACmD,GAAG,CAAC7B,KAAI,KAAM;UAC/C,GAAGA,KAAK;UACRc,SAAS,EAAEtC,MAAM,CAACwB,KAAK,CAACc,SAAS,CAAC,CAACgB,MAAM,CAAC,YAAY,CAAC;UACvDC,OAAO,EAAEvD,MAAM,CAACwB,KAAK,CAAC+B,OAAO,CAAC,CAACD,MAAM,CAAC,YAAY;QACpD,CAAC,CAAC,KAAK,EAAE;MACX,EAAE,OAAOE,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAAC;QACvD,IAAI,CAACE,SAAS,CAAC,kDAAkD,EAAE,OAAO,CAAC;MAC7E,UAAU;QACR,IAAI,CAAC7C,SAAQ,GAAI,KAAK;MACxB;IACF,CAAC;IACD,MAAM8C,oBAAoBA,CAAA,EAAG;MAC3B,MAAM,IAAI,CAAC1C,kBAAkB,CAAC,CAAC;MAC/B,IAAI,CAACyC,SAAS,CAAC,wCAAwC,EAAE,SAAS,CAAC;IACrE,CAAC;IACDE,gBAAgBA,CAACpC,KAAK,EAAE;MACtB,IAAI,CAACnB,aAAY,GAAI;QAAE,GAAGmB;MAAM,CAAC;MACjC,IAAI,CAACpB,uBAAsB,GAAI,IAAI;IACrC,CAAC;IACDyD,iBAAiBA,CAAA,EAAG;MAClB,IAAI,CAACzD,uBAAsB,GAAI,KAAK;MACpC,IAAI,CAACC,aAAY,GAAI,CAAC,CAAC;IACzB,CAAC;IACD,MAAMyD,YAAYA,CAACC,EAAE,EAAE;MACrB,IAAI;QACF,MAAMZ,QAAO,GAAI,MAAMpD,KAAK,CAACiE,GAAG,CAAC,oCAAoCD,EAAE,UAAU,CAAC;QAClF,IAAIZ,QAAQ,CAACvB,MAAK,KAAM,GAAG,EAAE;UAC3B,IAAI,CAACzB,aAAY,GAAI,IAAI,CAACA,aAAa,CAACkD,GAAG,CAAC7B,KAAI,IAC9CA,KAAK,CAACuC,EAAC,KAAMA,EAAC,GAAI;YAAE,GAAGvC,KAAK;YAAEI,MAAM,EAAE;UAAW,IAAIJ,KACvD,CAAC;UACD,IAAI,IAAI,CAACpB,uBAAuB,EAAE;YAChC,IAAI,CAACC,aAAa,CAACuB,MAAK,GAAI,UAAU;UACxC;UACA,IAAI,CAAC8B,SAAS,CAAC,8BAA8B,EAAE,SAAS,CAAC;QAC3D;MACF,EAAE,OAAOF,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;QAChD,IAAI,CAACE,SAAS,CAAC,4CAA4C,EAAE,OAAO,CAAC;MACvE;IACF,CAAC;IACD,MAAMO,eAAeA,CAACF,EAAE,EAAE;MACxB,IAAI;QACF,MAAMZ,QAAO,GAAI,MAAMpD,KAAK,CAACiE,GAAG,CAAC,oCAAoCD,EAAE,aAAa,CAAC;QACrF,IAAIZ,QAAQ,CAACvB,MAAK,KAAM,GAAG,EAAE;UAC3B,IAAI,CAACzB,aAAY,GAAI,IAAI,CAACA,aAAa,CAACkD,GAAG,CAAC7B,KAAI,IAC9CA,KAAK,CAACuC,EAAC,KAAMA,EAAC,GAAI;YAAE,GAAGvC,KAAK;YAAEI,MAAM,EAAE;UAAc,IAAIJ,KAC1D,CAAC;UACD,IAAI,IAAI,CAACpB,uBAAuB,EAAE;YAChC,IAAI,CAACC,aAAa,CAACuB,MAAK,GAAI,aAAa;UAC3C;UACA,IAAI,CAAC8B,SAAS,CAAC,iCAAiC,EAAE,SAAS,CAAC;QAC9D;MACF,EAAE,OAAOF,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;QACnD,IAAI,CAACE,SAAS,CAAC,+CAA+C,EAAE,OAAO,CAAC;MAC1E;IACF,CAAC;IACDQ,cAAcA,CAACtC,MAAM,EAAE;MACrB,QAAQA,MAAM;QACZ,KAAK,SAAS;UACZ,OAAO,mDAAmD;QAC5D,KAAK,UAAU;UACb,OAAO,iDAAiD;QAC1D,KAAK,aAAa;UAChB,OAAO,6CAA6C;QACtD;UACE,OAAO,+CAA+C;MAC1D;IACF,CAAC;IACDuC,UAAUA,CAACC,IAAI,EAAE;MACf,OAAOpE,MAAM,CAACoE,IAAI,CAAC,CAACd,MAAM,CAAC,cAAc,CAAC;IAC5C,CAAC;IACDe,SAASA,CAACC,GAAG,EAAE;MACb,IAAI,IAAI,CAAC7D,OAAM,KAAM6D,GAAG,EAAE;QACxB,IAAI,CAAC5D,aAAY,GAAI,IAAI,CAACA,aAAY,KAAM,KAAI,GAAI,MAAK,GAAI,KAAK;MACpE,OAAO;QACL,IAAI,CAACD,OAAM,GAAI6D,GAAG;QAClB,IAAI,CAAC5D,aAAY,GAAI,KAAK;MAC5B;IACF,CAAC;IACD6D,eAAeA,CAAA,EAAG;MAChB,IAAI,CAAC5D,WAAU,GAAI,CAAC,EAAE;IACxB,CAAC;IACD6D,QAAQA,CAAA,EAAG;MACT,IAAI,IAAI,CAAC7D,WAAU,GAAI,CAAC,EAAE,IAAI,CAACA,WAAW,EAAE;IAC9C,CAAC;IACD8D,QAAQA,CAAA,EAAG;MACT,IAAI,IAAI,CAAC9D,WAAU,GAAI,IAAI,CAACmC,UAAU,EAAE,IAAI,CAACnC,WAAW,EAAE;IAC5D,CAAC;IACD+C,SAASA,CAACgB,OAAO,EAAEC,IAAG,GAAI,SAAS,EAAE;MACnC,IAAI,CAAC7D,YAAW,GAAI4D,OAAO;MAC3B,IAAI,CAAC3D,SAAQ,GAAI4D,IAAI;MACrBC,UAAU,CAAC,MAAM,IAAI,CAACC,UAAU,CAAC,CAAC,EAAE,IAAI,CAAC;IAC3C,CAAC;IACDA,UAAUA,CAAA,EAAG;MACX,IAAI,CAAC/D,YAAW,GAAI,EAAE;MACtB,IAAI,CAACC,SAAQ,GAAI,SAAS;IAC5B;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}